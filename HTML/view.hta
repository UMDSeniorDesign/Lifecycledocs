<html>
	<head>
		<HTA:APPLICATION
		border="thin"
		borderStyle="normal"
		caption="yes"
		maximizeButton="yes"
		minimizeButton="yes"
		showInTaskbar="no"
		windowState="maximize"
		innerBorder="yes"
		navigable="yes"
		scroll="auto"
		scrollFlat="yes" />
	    <style type="text/css">
		    #preview {
		        float: right;
		        width: 60%;
		        height: 80%;
		    }
		    #tableOfContents {
		        float: left;
		        width: 40%;
		        height 80%;
		    }
		    #head {
		        width:100%%; 
		        height:20%
		    }
	    </style>
		
		<script> 
			/*function loadXML(dname) {
				if (window.XMLHttpRequest) {
					xmlhttp =  new XMLHttpRequest();
				} else { 
					xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
				}
				
				if (xmlhttp!=null) { 
					xmlhttp.open("GET",dname,false);
					xmlhttp.send();
					return xmlhttp.responseXML;
                } else { // If error occurs
					alert("error");
				}
			} ;*/
		</script>
		
		<script>
		    function getTableOfContents(doc) {
				document.getElementById("tableInput").innerHTML = '';
		         //document.getElementById("tableInput").empty();
		         //document.getElementById("textInput").empty();
                document.getElementById("textInput").value = '';
                
	            var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.6.0");
				xmlDoc.async = false;
				xmlDoc.load("../XML/" + doc + ".xml");
				//alert(xmlDoc.xml);
	            var y = "";
	            var y = xmlDoc.documentElement.childNodes;
	       
	            for (i = 0; i < y.length; i++) {
	                if (y[i].nodeType != 3) {
						var table = document.getElementById("tableInput");
						table.innerHTML += ("<a href='" + y[i].childNodes[0].nodeValue + "'>" + y[i].nodeName + "</a> <br>");
                        //document.getElementById("tableInput").append("<a href='" + y[i].childNodes[0].nodeValue + "'>" + y[i].nodeName + "</a> <br>");
                        //document.getElementById("textInput").append(y[i].childNodes[0].nodeValue + "\n");
						var text = document.getElementById("textInput");
						text.value += (y[i].childNodes[0].nodeValue + "\n");
                        
                        for (z = 0; z < y[i].childNodes.length; z++) {
                            if (y[i].childNodes[z].nodeType != 3) {
								var subTable = document.getElementById("tableInput");
								subTable.innerHTML += ("<a href='" + y[i].childNodes[z].childNodes[0].nodeValue + "'>" + y[i].childNodes[z].nodeName  + "</a> <br>");
                                //document.getElementById("tableInput").append("<a href='" + y[i].childNodes[z].childNodes[0].nodeValue + "'>" + y[i].childNodes[z].nodeName  + "</a> <br>");
                                //document.getElementById("textInput").append(y[i].childNodes[z].childNodes[0].nodeValue + "\n");
								var subText = document.getElementById("textInput");
								subText.value += (y[i].childNodes[z].childNodes[0].nodeValue + "\n");
                            }
                        }
                    }
	            }
				//alert(document.getElementById("tableInput").value);
		    }
		</script>
		
		<!--<script>
		    function editSection(y, i) {
		       $('#textInput').append(y[i].childNodes[0].nodeValue + "\n");
		    }
		</script>-->
	</head>
	
	<body>
		<div id="wrapper">
		    <div="head">
		        <button onclick="getTableOfContents('SoftwareRequirements');">Software Requirements</button>
		        <button onclick="getTableOfContents('TestCases');">Test Case</button>
		        <button onclick="getTableOfContents('UseCases');">Use Case</button>
		        <button onclick=location.href='rtm.hta'>Create Matrix</button>
		    </div>
			<div id="tableOfContents">
			    <h1>Table of Contents</h1>
			    <div id="tableInput"></div>
			</div>
			<div id="preview">
			    <h1>Preview</h1>
			    <textarea id="textInput" style="width: 100%; height: 100%"></textarea>
			    <button onclick=location.href='index.hta'>Exit & Save</button>
			</div>
		</div>
	</body>
</html>
