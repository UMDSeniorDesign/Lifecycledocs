<html>
	<head>
		<HTA:APPLICATION
		border="thin"
		borderStyle="normal"
		caption="yes"
		maximizeButton="yes"
		minimizeButton="yes"
		showInTaskbar="no"
		windowState="maximize"
		innerBorder="yes"
		navigable="yes"
		scroll="auto"
		scrollFlat="yes" />
	    <style type="text/css">
		    #preview {
		        float: right;
		        width: 60%;
		        height: 60%;
		    }
		    #tableOfContents {
		        float: left;
		        width: 40%;
		        height 80%;
		    }
		    #head {
		        width:100%%; 
		        height:20%
		    }
	    </style>
		
		<script src="../JS/loadXML.js"></script>
		<script src="../JS/updateXML.js"></script>
		<script src="../JS/saveXML.js"></script>
		<script src="../JS/store.js"></script>
		
		<script>
		    function getTableOfContents(file_name) {
				var XML = loadXML(file_name);
				
				var y = XML.documentElement.childNodes;
				
				var table = document.getElementById("tableInput");
				var text = document.getElementById("textInput");
				
				document.getElementById("tableInput").innerHTML = '';
                document.getElementById("textInput").value = '';
	       
	            for (i = 0; i < y.length; i++) {
					table.innerHTML += ("<a href='edit.hta'; onclick='store(i)'>" + y[i].nodeName + "</a> <br>");	
					text.value += (y[i].childNodes[0].nodeValue + "\n");
                 
					document.cookie = y[i].nodeName + "=" + y[i].childNodes[0].nodeValue;
					
                        for (z = 0; z < y[i].childNodes.length; z++) {
                            if (y[i].childNodes[z].nodeType != 3) {	
								//var subTable = document.getElementById("tableInput");
								table.innerHTML += ("<a href='edit.hta'; >" + y[i].childNodes[z].nodeName  + "</a> <br>");

								//var subText = document.getElementById("textInput");
								text.value += (y[i].childNodes[z].childNodes[0].nodeValue + "\n");
								
								document.cookie = y[i].childNodes[z].nodeName + "=" + y[i].childNodes[z].childNodes[0].nodeValue;

                            }
                        }
                }
				
				alert(document.cookie);
	        }		
		</script>

	</head>
	
	<body>
		<div id="wrapper">
		    <div="head">
		        <button onclick="getTableOfContents('SoftwareRequirements');">Software Requirements</button>
		        <button onclick="getTableOfContents('TestCases');">Test Case</button>
		        <button onclick="getTableOfContents('UseCases');">Use Case</button>
		        <button onclick=location.href='rtm.hta'>Create Matrix</button>
		    </div>
			<div id="tableOfContents">
			    <h1>Table of Contents</h1>
			    <div id="tableInput"></div>
			</div>
			<div id="preview">
			    <h1>Preview</h1>
			    <textarea id="textInput" style="width: 100%; height: 100%"></textarea>
				<button onclick="updateXML()">Update</button>
			    <button onclick="saveXML()">Save</button>
			</div>
		</div>
	</body>
</html>
