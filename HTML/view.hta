<html>
	<head>
		<HTA:APPLICATION
		border="thin"
		borderStyle="normal"
		caption="yes"
		maximizeButton="yes"
		minimizeButton="yes"
		showInTaskbar="no"
		windowState="maximize"
		innerBorder="yes"
		navigable="yes"
		scroll="auto"
		scrollFlat="yes" />
	    <style type="text/css">
		    #preview {
		        float: right;
		        width: 60%;
		        height: 60%;
		    }
		    #tableOfContents {
		        float: left;
		        width: 40%;
		        height 80%;
		    }
		    #head {
		        width:100%%; 
		        height:20%
		    }
	    </style>
		
		<script src="../JS/loadXML.js"></script>
		<script src="../JS/updateXML.js"></script>
		<script src="../JS/saveXML.js"></script>
		<script src="../JS/store.js"></script>
		<script src="../JS/getFromCookie.js"></script>
		
		<script>
		    function getTableOfContents(file_name) {
				var cookieFile = getFromCookie("fileName");
				if(file_name == "current" && cookieFile != ""){
					//set filename to the one stored in cookie so page loads Table of Contents
					file_name = cookieFile;
				}
				if(file_name == "current" && cookieFile == ""){
					//Initial Load, used to avoid null pointer error
					return;
				}
				var XML = loadXML(file_name);
				var y = XML.documentElement.childNodes;
				
				if(cookieFile != file_name){
					document.cookie = "fileName="+file_name;
					for (i = 0; i < y.length; i++) {
						document.cookie = y[i].nodeName + "=" + y[i].childNodes[0].nodeValue;
					}
				}
				
				var table = document.getElementById("tableInput");
				var text = document.getElementById("textInput");
				
				var counter = 1;
				
				document.getElementById("tableInput").innerHTML = '';
                document.getElementById("textInput").value = '';
	       
	            for (i = 0; i < y.length; i++) {
					table.innerHTML += ("<a href='edit.hta'; onclick='checkCookie("+counter+")';>" + y[i].nodeName + "</a> <br>");	
					//text.value += (y[i].childNodes[0].nodeValue + "\n");
					
					counter++;
					
                        /*for (z = 0; z < y[i].childNodes.length; z++) {
                            if (y[i].childNodes[z].nodeType != 3) {	
								table.innerHTML += ("<a href='edit.hta'; onclick='checkCookie("+counter+")'; >" + y[i].childNodes[z].nodeName  + "</a> <br>");
								text.value += (y[i].childNodes[z].childNodes[0].nodeValue + "\n");
								
								document.cookie = y[i].childNodes[z].nodeName + "=" + y[i].childNodes[z].childNodes[0].nodeValue;

								counter++;
                            }
                        } */
                }	
				
				getValues();
	        }		
		</script>
			
		<script>
			function getValues() {
				cookiearray = document.cookie.split(';');
				
				var text = document.getElementById("textInput");

				for(var i = 0; i < cookiearray.length; i++) {
					text.value += cookiearray[i].split('=')[1];
					text.value += "\n";
				}
				
			}
		</script>
		
	</head>
	
	<body onload="getTableOfContents('current')">
		<div id="wrapper">
		    <div="head">
		        <button onclick="getTableOfContents('SoftwareRequirements');">Software Requirements</button>
		        <button onclick="getTableOfContents('TestCases');">Test Case</button>
		        <button onclick="getTableOfContents('UseCases');">Use Case</button>
		        <button onclick=location.href='rtm.hta'>Create Matrix</button>
		    </div>
			<div id="tableOfContents">
			    <h1>Table of Contents</h1>
			    <div id="tableInput"></div>
			</div>
			<div id="preview">
			    <h1>Preview</h1>
			    <textarea id="textInput" style="width: 100%; height: 100%"></textarea>
			    <button onclick="saveXML()">Save</button>
			</div>
		</div>
	</body>
</html>
