<html>
	<head>
		<HTA:APPLICATION
		border="thin"
		borderStyle="normal"
		caption="yes"
		maximizeButton="yes"
		minimizeButton="yes"
		showInTaskbar="no"
		windowState="maximize"
		innerBorder="yes"
		navigable="yes"
		scroll="auto"
		scrollFlat="yes" />
	    <style type="text/css">
		    #xsltDiv {
				
		    }
	    </style>
		
		<script src="../JS/loadXML.js"></script>
		<script src="../JS/updateXML.js"></script>
		<script src="../JS/saveXML.js"></script>
		<script src="../JS/getFromSessvar.js"></script>
		<script src="../JS/sessionvars.js"></script>
		
		<script>
			function checkCookie(value) {
				sessvars.value = value;
			}
		</script>
		
		<script>
			function getTabs() {
				var y = loadProject(sessvars.projectName);
				
				var name = y.documentElement.childNodes;
				var div = document.getElementById("head1");
												
				for(var i = 0; i < name.length; i++) {
					div.innerHTML += ("<button onclick=getTableOfContents('"+name[i].childNodes[0].nodeValue+"');>"+name[i].childNodes[0].nodeValue+"</button>");	// Quotes needed to be in right place
				}
			}
		</script>
		
		<script>
			function loadXSLT(){
			//Load tabs from project file
			getTabs();
			
			//Load XML and XSL
			var xml = loadXML("NotionalSRS2.xml");
			var xsl = loadXML("NotionalXSL.xsl");
			
			//Transform XML to HTML
			value = xml.transformNode(xsl);
			//alert(value);
			
			//Search for script in generated HTML, this should be put into a loop in case of multiple scripts
			var scriptStart = value.search("<script>");
			var scriptEnd = value.search("<"+'/'+"script>");
			
			//Create substring that is the script, offset start because script tag is inserted with createElement method
			var xsltScript = value.substring(scriptStart+8, scriptEnd);
			
			//Find the head so we know where to append
			var head = document.getElementsByTagName('head')[0];
			
			//Create our new script object
			var script = document.createElement('script');
			script.type = 'text/javascript';
			script.text = xsltScript;
			
			//Append it to the head
			head.appendChild(script);
			//alert(head.innerHTML);
			
			//Search for the style in generated HTML
			var styleStart = value.search('<style type="text'+'/'+'css">');
			var styleEnd = value.search("<"+'/'+"style>");
			//Create substring that is the style
			var xsltStyle = value.substring(styleStart+23, styleEnd);
			
			//Find Style insert location
			var styleSpot = head.getElementsByTagName('style')[0];
			var sheet = document.styleSheets[0];
			
			var oldStyle = styleSpot.innerHTML.substring(0, 12);
			var newStyle = (oldStyle + xsltStyle + '}');
			sheet.cssText = newStyle;
			//alert(newStyle);
			//alert(styleSpot.innerHTML);
			
			//Append our generated HTML to the newly formatted page
			document.getElementById("xsltDiv").innerHTML = value;
			}
		</script>
		
		
	</head>
	
	<body onload="loadXSLT()">
		<div id="wrapper">
		    <div id="head1">
				<!--
				<button onclick="getTableOfContents('NotionalSRSTEST');">NotionalSRS</button>
				<button onclick="getTableOfContents('NotionalSRSTest2');">NotionalSRSTest</button>
		        <button onclick="getTableOfContents('SoftwareRequirements');">Software Requirements</button>
		        <button onclick="getTableOfContents('TestCases');">Test Case</button>
		        <button onclick="getTableOfContents('UseCases');">Use Case</button>
				-->
		        <button onclick=location.href='rtm.hta'>Create Matrix</button>
		    </div>
			<div id="xsltDiv">
			    <h4>Preview</h4>
			    <button onclick="saveXML()">Save</button>
			</div>
		</div>
	</body>
</html>
