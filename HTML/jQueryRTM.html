<!DOCTYPE html>
<html>
    <head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js" > </script>
    <script type="text/javascript" src="http://www.kunalbabre.com/projects/table2CSV.js" > </script>
    
    <script>
        // Handler for .ready() called.
        $( document ).ready(function() {
        //Init xmlhttp for appropriate browser
        if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else { // code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        //Get Requirements XML -> store in x
        xmlhttp.open("GET","/Lifecycledocs/XML/requirements.xml",false);
        xmlhttp.send();
        xmlDoc=xmlhttp.responseXML; 
        var x=xmlDoc.getElementsByTagName("Requirement");
        
        //Get useCase XML -> store in y
        xmlhttp.open("GET","/Lifecycledocs/XML/useCase.xml",false);
        xmlhttp.send();
        xmlDoc=xmlhttp.responseXML; 
        var y=xmlDoc.getElementsByTagName("Section");
        
        //Get testCase XML -> store in z
        xmlhttp.open("GET","/Lifecycledocs/XML/testCase.xml",false);
        xmlhttp.send();
        xmlDoc=xmlhttp.responseXML; 
        var z=xmlDoc.getElementsByTagName("Section");
        
        //Write Table
        var content = "<table border='1'>"
        
        content += '<tr><td>' + 'Requirement ' + '</td><td>' + 'Location' + '</td><td>' + 'ID' + '</td><td>' + 'Use Case Location' + '</td><td>' + 'Test Case Location' + '</td><td>' + 'Tested By' + '</td><td>' + 'Result' + '</td><td>' + 'Date' + '</td></tr>';
        
        for (i=0;i<x.length;i++) { 
            //Add Requirement
            content += '<tr><td>';
            content += x[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
            //Add Requirement Location
            content += '</td><td>';
            content += x[i].getElementsByTagName("section")[0].childNodes[0].nodeValue;
            //Add ID
            content += '</td><td>';
            content += x[i].getElementsByTagName("id")[0].childNodes[0].nodeValue;
            //Search Use case doc for current Requirement
            content += '</td><td>';
            for (j=0;j<y.length;j++) {
                if(x[i].getElementsByTagName("id")[0].childNodes[0].nodeValue == y[j].getElementsByTagName("requirement")[0].childNodes[0].nodeValue) {
                    content += y[j].getElementsByTagName("number")[0].childNodes[0].nodeValue;
                }
            }
            //Search Test case doc for current Requirement
            content += '</td><td>';
            for (j=0;j<y.length;j++) {
                if(x[i].getElementsByTagName("id")[0].childNodes[0].nodeValue == z[j].getElementsByTagName("requirement")[0].childNodes[0].nodeValue) {
                    //Write Test case location
                    content += z[j].getElementsByTagName("number")[0].childNodes[0].nodeValue;
                    content += '</td><td>';
                    var test = z[j].getElementsByTagName("testedBy")[0].childNodes[0].nodeValue;
                    if (test != '*'){
                        content += test;
                    }
                    content += '</td><td>';
                    test = z[j].getElementsByTagName("status")[0].childNodes[0].nodeValue;
                    if (test != '*'){
                        content += test;
                    }
                    content += '</td><td>';
                    test = z[j].getElementsByTagName("date")[0].childNodes[0].nodeValue;
                    if (test != '*'){
                        content += test;
                    }
                }
            }
            content += '</td></tr>';
        }
        
        content += '</table>';
        $('#RTM').append(content);
        
        //$('#RTM').table2CSV();
        
        });
    </script>
    </head>
    <body>
    <center>
    <div id="RTM"></div>
    </center>
    </body>
</html>